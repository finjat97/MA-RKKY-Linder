\newpage
\section{Numerical Approach} \label{sec:numerical}
\begin{itemize}
    \item basis
    \item Hamiltonian
    \item partial transformation to k-space
    \item degrees of freedom
    \item density of states
    \item self-consistency equation for gap
\end{itemize}
In addition to the analytical approach, the two dimensional Hamiltonian is diagonalized numerically via \emph{python}.
The formulation of the Hamiltonian is done in a spin basis with the structure of a Nambu-basis \cite{original.pdf} \textcolor{red}{How can I cite this? Who wrote this?}.
The boundary conditions are chosen to be hard-wall for the x-direction and periodic for the y-direction.
Consequently, the real-space Hamiltonian has to be partially Fourier-transformed by
\begin{equation}\nonumber
    c_{\Vec{i},\sigma} = \frac{1}{N_y} \sum_{k_y} c_{i_x,k_y, \sigma} e^{i(k_y i_y)}
\end{equation}
That allows to express the Hamilton operator of the system as 
\begin{equation}\nonumber
    H = H_0 + \frac{1}{2} \sum_{k_y} W^{\dag}_{k_y}H_{k_y}W_{k_y}
\end{equation}
where $W_{k_y}$ is the vector containing $B_{i_x, k_y}$ for all positions in x-direction $i_x$ of the system.
$B_{i_x, k_y}$ contains the Nambu-basis for one position $i_x$, which has the form
\begin{equation}
    \Psi^{\dag}_{i_x} = \left( c^{\dag}_{i_x, \uparrow}, c^{\dag}_{i_x, \downarrow}, c_{i_x, \uparrow}, c_{i_x, \downarrow} \right)
\end{equation}
The matrix $H_{k_y}$ is of dimension $4N_x \times 4N_x$, where $N_x$ is the number of lattice sites in x-direction.\newline
The SOC term $H_{SOC}$ transforms under the partial Fourier transformation as
\begin{align} \nonumber
    H_{SOC} &= i \gamma \sum_{\langle i,j \rangle, \alpha, \beta} c^{\dag}_{i,\alpha} \vb{n} \cdot \left(\vb{d}_{i,j} \times \Vec{\sigma} \right) c_{j,\beta} \\ \nonumber
    &= \frac{i\gamma}{N} \sum_{\substack{i_x, j_x, \Vec{\delta}\\ k_y, k'_y, \alpha, \beta}} c^{\dag}_{i_x, k_y, \alpha}\left( \Vec{\delta}\cdot \vb{y}\sigma_x - \Vec{\delta}\cdot\vb{x}\sigma_y\right) c_{i_x+\Vec{\delta}\cdot\vb{x},k'_y, \beta}\,e^{-ik_yi_y}\,e^{ik'_y(i_y+\Vec{\delta}\cdot\vb{y})}\\ \nonumber
    &= i \gamma \sum_{i_x \Vec{\delta}, k_y, \alpha, \beta} c^{\dag}_{i_x,k_y,\alpha}\left( \Vec{\delta}\cdot \vb{y}\sigma_x - \Vec{\delta}\cdot\vb{x}\sigma_y \right)c_{i_x+\Vec{\delta}\cdot\vb{x},k_y,\beta}\, e^{ik_y\Vec{\delta}\cdot\vb{y}} \\ \nonumber
    &= \gamma \sum_{i_x, k_y, \alpha, \beta} \left[ c^{\dag}_{i_x,k_y, \alpha} (i\sigma_y)_{\alpha\beta} c_{j_x,k_y,\beta}(\delta_{j_x, i_x+1} - \delta_{j_x, i_x-1}) - c_{i_x, k_y, \alpha} (\sigma_x)_{\alpha\beta} c_{j_x,k_y,\beta} \delta_{i_xj_x} 2 \sin{(k_ya)} \right]
\end{align}
where $\Vec{\delta}$ is the distance between two nearest-neighbors on a square lattice with lattice constant $a$.
Therefore, there are local and nearest-neighbor terms in the SOC, although the original term contained only nearest neighbor terms.
Terms local in x-direction arise due to the transformation because the nearest-neighbor in y-direction has a different $k_y$-value, but the same $i_x$-value. \newline
The components of $H_{k_y}$ can be expressed by the following $4x4$ matrix
\begin{align}\label{eq:hamiltonian_num}
    &H_{i_x, j_x, k_y} = \\ \nonumber
   & \left[ {\begin{smallmatrix}
            \epsilon^{\uparrow}(k_y) & \xi^{\uparrow}_{i_x}(k_y,-\gamma) & V^{\uparrow}_{i_x, k_y}(\delta_{i_x,j_x+1}-\delta_{i_x,j_x-1})& U^*_{i_x, k_y}\delta_{i_x,j_x} \\
          \xi^{\downarrow}_{i_x}(k_y, +\gamma) & \epsilon^{\downarrow}(k_y) & -U^*_{i_x, k_y}\delta_{i_x,j_x} & -(V^{\downarrow}_{i_x, k_y})^*(\delta_{i_x,j_x+1}-\delta_{i_x,j_x-1})\\
          (V^{\uparrow}_{i_x, k_y})^*(\delta_{i_x,j_x+1}-\delta_{i_x,j_x-1}) & -U_{i_x, k_y}\delta_{i_x,j_x}& -\epsilon^{\uparrow}(k_y) & -\xi^{\uparrow}_{i_x}(k_y, -\gamma) \\
          U_{i_x, k_y}\delta_{i_x,j_x} & -V^{\downarrow}_{i_x, k_y} (\delta_{i_x,j_x+1}-\delta_{i_x,j_x-1})  & -\xi^{\downarrow}_{i_x}(k_y, +\gamma) & -\epsilon^{\downarrow}(k_y)
        \end{smallmatrix} } 
        \right]
\end{align}
% \textcolor{red}{Does it make sense what I am doing with the terms that depend on $k_x$ in original.pdf? Can I just set those terms to zero? } \newline
with the short-hand notation 
\begin{align}\nonumber
    \epsilon^{\sigma}(k_y) &= \left( -2t \cos{(k_y)}\right)(\delta_{i_x,j_x+1}+\delta_{i_x,j_x-1})-\mu\delta_{i_x,j_x} + J\Vec{S}_{i_x}\Vec{\sigma}_{\sigma \sigma}\delta_{i_x,i} \\ \label{eq:ham_num_shorthand}
    \xi^{\sigma}_{i_x}(k_y,\pm \gamma) &= \left( -2 \gamma \sin{(k_ya)} \, (\sigma_x)_{\sigma-\sigma}+ J\Vec{S}_{i_x}\Vec{\sigma}_{\sigma, -\sigma}\delta_{i_x,i}\right)\delta_{i_x,j_x} \pm\gamma (\delta_{j_x,i_x+1}-\delta_{j_x,i_x-1})
\end{align}
\textcolor{red}{Add complex conjugation of $\sigma_{\sigma, \sigma'}$ for the non-normal ordered combinations} \newline
In addition, $\delta_{i_x,i}$ selects all those sites $i_x$ which contain an impurity spin.\newline
This matrix describes the on-site as well as nearest-neighbor interaction of the system and the SOC is already of Rashba-type, which can be seen in the fact that triplet pairing is only consider for the case of equal spins \cite{frigeri2004superconductivity}. \textcolor{red}{Explain}.
Since there are many zero-entries in each $H_{k_y}$ and their amount grows with system size, it is advisable to use a sparse-matrix format.
\newline
When looking at the eigenvalue equations of $H_{k_y}$, one finds that if $E_{n,k_y}$ is an eigenvalue of $H_{k_y}$ then $-E_{n,-k_y}$ is also an eigenvalue of $H_{k_y}$.
The eigenvector of $-E_{n,-k_y}$ is found to be the complex conjugate of the eigenvector of $E_{n,k_y}$, when additionally the momentum is reversed.
This symmetry can be exploited when diagonalizing the Hamiltonian numerically. \newline
The diagonalized Hamiltonian can be expressed by the diagonal matrix $D$, which contains all eigenvalues, when the original basis $W$ is transformed into a new basis $\Gamma$.
This new basis is the eigenbasis of the Hamiltonian and defined by the relation 
\begin{equation}
    \Gamma^{\dag}_{k_y} = W^{\dag}_{k_y} P_{k_y} = \left( \gamma_{k_y,1}, \gamma_{k_y,2}, \hdots \gamma_{k_y,4N_x}\right)
\end{equation}
where $P_{k_y}$ contains all eigenvectors as columns. 
The components of these eigenvectors can be labeled as $\left( u_{1,n,k_y}, v_{1,n,k_y}, w_{1,n,k_y}, x_{1,n,k_y}, u_{2,n,k_y}, \hdots x_{N_x,n,k_y}\right)^T$, which leads to the definition of each single entry of the eigenbasis-vector as
\begin{equation}
    \gamma^{\dag}_{k_y,n} = \sum_{i_x} \left( c^{\dag}_{i_x,k_y,\uparrow} u_{i_x,n,k_y} + c^{\dag}_{i_x,k_y,\downarrow}v_{i_x,n,k_y} + c_{i_x,-k_y,\uparrow} w_{i_x,n,k_y} + c^{\dag}_{i_x,-k_y,\downarrow} x_{i_x,n,k_y}\right)
\end{equation}
Using the symmetry of the eigenvectors, which can be written as \\ $\left( w^*_{1,n,k_y}, x^*_{1,n,k_y}, u^*_{1,n,k_y}, v^*_{1,n,k_y}, w^*_{2,n,k_y}, \hdots v^*_{N_x,n,k_y}\right)^T$ and therefore the eigenbasis-vector components can also be defined as 
\begin{equation}
    \gamma^{\dag}_{-k_y,n} = \sum_{i_x} \left( c^{\dag}_{i_x,-k_y,\uparrow} w^*_{i_x,n,k_y} + c^{\dag}_{i_x,-k_y,\downarrow} x^*_{i_x,n,k_y} + c_{i_x,k_y,\uparrow} u^*_{i_x,n,k_y} + c_{i_x,k_y,\downarrow} v^*_{i_x,n,k_y}\right) 
\end{equation}
which also follows from the relation $W_{-k_y} = P_{-k_y}\Gamma_{-k_y}$.
It follows directly, that $\gamma^{\dag}_{-k_y,n} = \gamma_{k_y,n}$, which implies that not all $\gamma_{k_y,n}$ operators are independent of each other for all $k_y$-values what restores the correct amount of degrees of freedom. \newline
The diagonal Hamiltonian can now be written in terms of the new operators and reads
\begin{equation} \nonumber
    H = H_0 + \frac{1}{2} \sum_{n,k_y>0} E_{n,k_y}\gamma^{\dag}_{n,k_y}\gamma_{n,k_y} + \frac{1}{2} \sum_{n,k_y<0} E_{n,k_y}\gamma^{\dag}_{n,k_y}\gamma_{n,k_y} + K
\end{equation}
where the sum was split into a $k_y<0$, $k_y>0$ and $k_y=0$ part.
The latter is going to be treated in detail later and simply denoted by $K$ for now.
Substituting $E_{n,k_y} \rightarrow -E_{n,k_y}$ in the sum over $k<0$ allows to use the relation $\gamma^{\dag}_{-k_y,n} = \gamma_{k_y,n}$ in the $k<0$ term.
When renaming $k_y \rightarrow -k_y$ and apply the relation $\gamma^{\dag}_{-k_y,n} = \gamma_{k_y,n}$ a second time, the Hamiltonian reads
\begin{equation} \nonumber
    H = H_0 -\frac{1}{2} \sum_{n, k_y >0} E_{n,k_y} + \sum_{n, k_y >0} E_{n,k_y}\gamma^{\dag}_{k_y,n}\gamma_{k_y,n} + K
\end{equation}
% When setting $\langle \gamma^{\dag}_{k_y,n}\gamma_{k_y,n} \rangle = f(E_{n,k_y})$ for $k>0$ with $f(x)$ being the Fermi-Dirac distribution, the free energy of the system evaluates to
% \begin{equation}
%     F = H_0 - \frac{1}{2} \sum_{n, k_y >0} E_{n,k_y} - \frac{1}{\beta} \sum_{n, k_y >0} ln\left( a+ e^{-\beta E_{n,k_y}}\right) + F_K
% \end{equation}
% where $F_K$ is the contribution form the $k_y=0$ mode.
In order to evaluate the $k_y=0$ term, the problem that this mode does not have a negative partner has to be resolved.
% The allowed $k_y$-values on a lattice with periodic boundary conditions generally are $k_y = \frac{2\pi n}{N a}$ with $N$ the number of lattice points, $a$ the lattice constant and $n$ an integer.
% For even $N$ the modes can be set to
% \begin{equation} \nonumber
%     k_y = -\pi, -\pi +\frac{2 \pi}{N}, \hdots, 0, \frac{2\pi}{N}, \hdots, \pi-\frac{2\pi}{N}
% \end{equation}
% ans similarly for odd $N$
% \begin{equation}\nonumber
%     k_y = -\pi +\frac{\pi}{N}, -\pi +\frac{3\pi}{N}\hdots, 0, \hdots, \pi-\frac{\pi}{N}
% \end{equation}
% Therefore, there is no negative partner for $k_y =0$.
That is done by apply the relation $\gamma^{\dag}_{-k_y,n} = \gamma_{k_y,n}$ and using that the eigenvalues of $H{-k_y}$ are $-E_{n,k_y}$, since the Hamiltonian then is
\begin{equation}\nonumber
    H = H_0 - \frac{1}{2} \sum_{n,k_y>0} E_{n,k_y}+ \frac{1}{2} \sum_{n,k_y>0} E_{n,k_y}\gamma^{\dag}_{n,k_y}\gamma_{n,k_y} + \frac{1}{2}\sum_n E_{n,0}\gamma^{\dag}_{n,0}\gamma_{n,0}
\end{equation}
Here, the Fermi-Dirac distribution may be used again, since all $\gamma$-operators in $\sum_{n,k_y>0}$ are independent in this formulation of the Hamiltonian. \newline
It is possible that for the $k_y = 0$ mode, $H_{k_y}=H_{-k_y}$ holds true.
In that case, it also holds that if $E_{n,0}$ is an eigenvalue then so is $-E_{n,0}$. 
Consequently, the eigenvalues can be sorted such that the first $2N_x$ ones are negative and the last $2N_x$ ones are positive. 
If one of the eigenvalues is zero, then there is a pair of eigenvalues equaling zero and the first and second half of the eigenvalues is going to contain one of them each.
The final expression for the Hamiltonian is therefore
\begin{equation} \label{eq:H_num}
    H = H_0 - \frac{1}{2} \sum_{n,k_y>0} E_{n,k_y} - \frac{1}{2} \sum_{E_{n,0}\geq 0} E_{n,0}+ \sum_{n,k_y>0} E_{n,k_y}\gamma^{\dag}_{n,k_y}\gamma_{n,k_y}+ \sum_{E_{n,0} \geq 0} E_{n,0}\gamma^{\dag}_{n,0}\gamma_{n,0}
\end{equation}
where all operators are independent of each other. 

%%%%%%%%%%%%%%%%%%%%%
\subsection{Self-consistency equation}\label{sec:num_gap}
One of the most interesting observables of a superconductor is the gap-order parameter.
It is defined in the context of the BCS theory explained in Sec. \ref{sec:BCS} and reads
\begin{equation}
    \nonumber
    \Delta_{i_x} = \frac{V_{i_x}}{N} \sum_{k_y} \langle c_{i_x, k_y, \uparrow}c_{i_x, -k_y, \downarrow}\rangle
\end{equation}
In the eigenbasis $\Gamma_{k_y}$ of the Hamiltonian, the gap expression transforms into
\begin{align} \nonumber
    \Delta_{i_x} &= \frac{V_{i_x}}{N}\left( \sum_{k_y >0} \langle c_{i_x, k_y, \uparrow}c_{i_x, -k_y, \downarrow}\rangle  +\sum_{k_y <0} \langle c_{i_x, k_y, \uparrow}c_{i_x, -k_y, \downarrow}\rangle + \langle c_{i_x,0, \uparrow}c_{i_x, 0, \downarrow}\rangle \right) \\ \nonumber
    &= \frac{V_{i_x}}{N}\left( \sum_{k_y >0,n} u_{i_x,n,k_y}x^*_{i_x,n,k_y}\langle \gamma_{n, k_y}\gamma^{\dag}_{n, k_y}\rangle  \right. \\ \nonumber
    &\left.+\sum_{k_y >0} w^*_{i_x,n,k_y}v_{i_x,n,k_y}\langle \gamma_{n, -k_y}\gamma^{\dag}_{n, -k_y}\rangle + u_{i_x,n,0}x^*_{i_x,n,0}\langle \gamma_{n, 0}\gamma^{\dag}_{n, 0}\rangle \right)
\end{align}
In the second step, the sum over $k_y<0$ was replaced by the sum over $k_y>0$ by changing the sign of $k_y$ in the whole expression including the operators.
The $k_y=0$ term is treated the same way as in the Hamiltonian and the relations $u_{i_x,2N_x+n,0} = w^*_{i_x, n,0}$ and $x_{i_x,2N_x+n,0} = v^*_{i_x, n,0}$ are used to arrive at the final expression
\begin{align} \nonumber
    \Delta_{i_x} = \frac{V_{i_x}}{N} &\left( \sum_{k_y >0,n} \left[ w^*_{i_x,n,k_y}v_{i_x,n,k_y}-u_{i_x,n,k_y}x^*_{i_x,n,k_y}\right]f(E_{n,k_y}) +u_{i_x,n,k_y}x^*_{i_x,n,k_y} \right. \\
    &+ \left.\sum_{E_n \geq0} \left[ w^*_{i_x,n,0}v_{i_x,n,0}-u_{i_x,n,0}x^*_{i_x,n,0}\right]f(E_{n,0})+ u_{i_x,n,0}x^*_{i_x,n,0} \right) \label{eq:gap_singlet_num}
\end{align}
where $\langle \gamma_{n, -k_y}\gamma^{\dag}_{n, -k_y}\rangle=f(E_{n,k_y})$ is used and $f(x)$ is again the Fermi-Dirac distribution. \newline
This calculation is done for the singlet-pairing as well as for the triplet-pairing gap.
For the latter the explicit form is
\begin{align} \nonumber
    \Delta_{t,i_x} &= \frac{V_{i_x, j_x}}{N} \sum_{k_y, \sigma} \langle c_{i_x, k_y, \sigma}c_{j_x, -k_y, \sigma}\rangle\\ \nonumber
    &= \frac{V_{i_x, j_x}}{N} \left( \sum_{k_y >0,n} \left[ w^*_{i_x,n,k_y}u_{j_x,n,k_y}-v_{i_x,n,k_y}x^*_{j_x,n,k_y}\right]f(E_{n,k_y}) +v_{i_x,n,k_y}x^*_{j_x,n,k_y} \right. \\ \nonumber
    &+ \left.\sum_{E_n \geq0} \left[ w^*_{i_x,n,0}u_{j_x,n,0}-v_{i_x,n,0}x^*_{j_x,n,0}\right]f(E_{n,0})+ v_{i_x,n,0}x^*_{j_x,n,0} \right) \\ \nonumber
    &+ \frac{V_{i_x, j_x}}{N} \left( \sum_{k_y >0,n} \left[ x^*_{i_x,n,k_y}v_{j_x,n,k_y}-u_{i_x,n,k_y}w^*_{j_x,n,k_y}\right]f(E_{n,k_y}) +u_{i_x,n,k_y}w^*_{j_x,n,k_y} \right. \\
    &+ \left.\sum_{E_n \geq0} \left[ x^*_{i_x,n,0}v_{j_x,n,0}-u_{i_x,n,0}w^*_{j_x,n,0}\right]f(E_{n,0})+ u_{i_x,n,0}w^*_{j_x,n,0} \right) 
    \label{eq:gap_triplet_num}
\end{align}
The total gap is obtained based on Eq. \ref{eq:gap_singlet+triplet}. \newline
\textcolor{red}{How do I plot a gap that has matrix form?} \newline
\textcolor{red}{How do I implement the fact that the triplet gap is on different sites?} \newline
\textcolor{red}{Do I really use the self-consistency equation or do I just set the values? For which reasons?}

\subsection{Local Density of States}
Since spin-impurities are introduced into the non-centrosymmetric superconductor and they are expected to interact and interfere with its behavior due to the local RKKY-interaction, it makes sense to study the local density of states (LDOS).
It allows to understand study the local symmetry characteristics and their dependencies. \newline
The starting point to derive the LDOS is the local charge in spin-basis, which can be expressed with the LDOS $D_i(E)$ and the occupation probability $f(E)$, which is the Fermi-Dirac distribution.
That can be rewritten with the coefficients of the eigenbasis
\begin{align}\nonumber
    \rho_i &= \int_{-\infty}^{\infty} D_i(E)f(E)dE = \sum_{\sigma} \langle c^{\dag}_{i,\sigma} c_{i,\sigma}\rangle\\ \nonumber
    &= \sum_n\left[  
    \left( |u_{i,n}|^2 + |v_{i,n}|^2\right)\left( 1- f(E_n) \right) + \left(|w_{i,n}|^2 + |x_{i,n}|^2\right)f(E_n)
    \right]
\end{align}
For a superconducting system, low temperatures can be assumed and therefore the Fermi-Dirac distribution can be approximated as a step-function.
That changes the upper limit of the integral $\infty \rightarrow 0$ and replaces the $f(E) \rightarrow 1$, which in turn allows the formulate the charge density as 
\begin{align}\nonumber
    \rho_i &= \sum_n\left[  
    \left( |u_{i,n}|^2 + |v_{i,n}|^2\right)\Theta(E_n) + \left(|w_{i,n}|^2 + |x_{i,n}|^2\right)\Theta(-E_n)
    \right] \\ \nonumber
    &= \int_{-\infty}^0 D_i(E) dE
\end{align}
where $\Theta(E)$ is the Heaveside step function.
The LDOS can therefore be obtained by calculating
\begin{equation}\label{eq:LDOS_num}
    D_i(E) = \sum_n\left[  
    \left( |u_{i,n}|^2 + |v_{i,n}|^2\right)\delta(E+E_n) + \left(|w_{i,n}|^2 + |x_{i,n}|^2\right)\delta(E-E_n)
    \right]
\end{equation}
In the implementation, the Dirac-delta function $\delta(E)$ is approximated by a Gaussian distribution with standard derivation of $0.05$.

\subsection{Orientation of Impurity Spins}
The orientation of the impurity spins is discussed analytically in Section \ref{sec:eff_interaction_spin} and leads to a combination of Heisenberg, Ising and Dzyaloshinskii-Moriya terms.\newline %\textcolor{red}{Insert results here}. \newline
For a numerical approach the symmetries of the possible impurity spin-1/2 orientations are exploited, which makes it possible to parameterize the spin-orientations and calculate their respective free energies. \newline
\textcolor{red}{What are the symmetries of the spin configurations? } \newline
Consequently, \textcolor{red}{Which orientations do I have to consider?} \newline
For each of this configurations the Hamiltonian is diagonalized and the free energy of the system is calculated based on
\begin{align}\label{eq:free_energy_num}
    F = \sum_{\substack{n,k>0}}\left[ -\frac{E_{n,k}}{2} - \frac{1}{\beta}\ln{(1+ e^{-\beta E_{n,k}})} \right] -\sum_{E_{n} \geq 0} \frac{E_{n,k=0}}{2} - \sum_{E_{n,k=0} \geq 0} \frac{1}{\beta}\ln{(1+ e^{-\beta E_{n,k=0}})}
\end{align}
% \subsection{Phase Diagram}
% If I ever get here: chapter 5.3.2 in Atousa's thesis
